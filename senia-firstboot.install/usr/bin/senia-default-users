#!/bin/bash

# This script is licensed under GPL v3
# or higher.

DEFAULTRC=0

SENIA_USERS="tic profe alumno"

if [ ! -z "$1" ]; then
    if [ "$1" = "--force" ]; then
	DEFAULTRC=1
	shift
    fi    
fi

for USERAUX in ${SENIA_USERS}; do 

	echo  " * [ Senia Default Users ] : Adding User [ ${USERAUX} ] "
	echo  "  --> Testing if ${USERAUX} exists"

	rc=$DEFAULTRC
	cat /etc/passwd | grep -q ${USERAUX}|| rc=1

	if [ $rc -eq 1 ]; then
	   echo "  --> The user : ${USERAUX} not exists : creating..."

	   adduser --quiet --disabled-password --shell /bin/bash --home /home/${USERAUX} --gecos ${USERAUX}  ${USERAUX}
	   echo "${USERAUX}:${USERAUX}" | chpasswd
	   if [ ${USERAUX} == "tic" ]; then
		   adduser ${USERAUX} adm
		   adduser ${USERAUX} sudo
	   fi
        else
	   echo "  --> The user is already system...nothing to do"
	fi

done

# Spagetti code
# TODO Fix this shit


USERAUX="daw"
PASSAUX="AdaLovelace"

echo  " * [ Senia Default Users ] : Adding User [ ${USERAUX} ] "

rc=$DEFAULTRC
cat /etc/passwd | grep -q ${USERAUX}|| rc=1

if [ $rc -eq 1 ]; then
	echo " --> The user : ${USERAUX} not exists : creating..."
   	adduser --quiet --disabled-password --shell /bin/bash --home /home/${USERAUX} --gecos ${USERAUX}  ${USERAUX}
else
	echo " --> The user exists ... nothing to do"
fi

echo " --> The user : ${USERAUX} must have the default passwd assigned"
echo "${USERAUX}:${PASSAUX}" | chpasswd

echo " [ Docker test ] "

##### DOCKER TEST
rd=0
getent group | grep -q docker || rd=1
if [ ${rd} -eq 0 ]; then
	echo " --> The user : ${USERAUX} must be able to run docker "
	adduser ${USERAUX} docker
else
	echo " Docker is not installed "
fi


USERAUX="smx"
PASSAUX="Turing"

echo  " * [ Senia Default Users ] : Adding User [ ${USERAUX} ] "

rc=$DEFAULTRC
cat /etc/passwd | grep -q ${USERAUX}|| rc=1

if [ $rc -eq 1 ]; then
	echo " --> The user : ${USERAUX} not exists : creating..."
   	adduser --quiet --disabled-password --shell /bin/bash --home /home/${USERAUX} --gecos ${USERAUX}  ${USERAUX}
else
	echo " --> The user exists ... nothing to do"
fi

echo " --> The user : ${USERAUX} must have the default passwd assigned"
echo "${USERAUX}:${PASSAUX}" | chpasswd


##### DOCKER TEST
rd=0
getent group | grep -q docker || rd=1
if [ ${rd} -eq 0 ]; then
	echo " --> The user : ${USERAUX} must be able to run docker "
	adduser ${USERAUX} docker
else
	echo " Docker is not installed "
fi



USERAUX="dam"
PASSAUX="Babbage"

echo  " * [ Senia Default Users ] : Adding User [ ${USERAUX} ] "

rc=$DEFAULTRC
cat /etc/passwd | grep -q ${USERAUX}|| rc=1

if [ $rc -eq 1 ]; then
	echo " --> The user : ${USERAUX} not exists : creating..."
   	adduser --quiet --disabled-password --shell /bin/bash --home /home/${USERAUX} --gecos ${USERAUX}  ${USERAUX}
else
	echo " --> The user exists ... nothing to do"
fi

echo " --> The user : ${USERAUX} must have the default passwd assigned"
echo "${USERAUX}:${PASSAUX}" | chpasswd

##### DOCKER TEST
rd=0
getent group | grep -q docker || rd=1
if [ ${rd} -eq 0 ]; then
	echo " --> The user : ${USERAUX} must be able to run docker "
	adduser ${USERAUX} docker
else
	echo " Docker is not installed "
fi



USERAUX="primero"
PASSAUX="Insercion"

echo  " * [ Senia Default Users ] : Adding User [ ${USERAUX} ] "

rc=$DEFAULTRC
cat /etc/passwd | grep -q ${USERAUX}|| rc=1

if [ $rc -eq 1 ]; then
	echo " --> The user : ${USERAUX} not exists : creating..."
   	adduser --quiet --disabled-password --shell /bin/bash --home /home/${USERAUX} --gecos ${USERAUX}  ${USERAUX}
else
	echo " --> The user exists ... nothing to do"
fi

echo " --> The user : ${USERAUX} must have the default passwd assigned"
echo "${USERAUX}:${PASSAUX}" | chpasswd


USERAUX="segundo"
PASSAUX="Burbuja"

echo  " * [ Senia Default Users ] : Adding User [ ${USERAUX} ] "

rc=$DEFAULTRC
cat /etc/passwd | grep -q ${USERAUX}|| rc=1

if [ $rc -eq 1 ]; then
	echo " --> The user : ${USERAUX} not exists : creating..."
   	adduser --quiet --disabled-password --shell /bin/bash --home /home/${USERAUX} --gecos ${USERAUX}  ${USERAUX}
else
	echo " --> The user exists ... nothing to do"
fi

echo " --> The user : ${USERAUX} must have the default passwd assigned"
echo "${USERAUX}:${PASSAUX}" | chpasswd


USERAUX="tercero"
PASSAUX="MergeSort"

echo  " * [ Senia Default Users ] : Adding User [ ${USERAUX} ] "

rc=$DEFAULTRC
cat /etc/passwd | grep -q ${USERAUX}|| rc=1

if [ $rc -eq 1 ]; then
	echo " --> The user : ${USERAUX} not exists : creating..."
   	adduser --quiet --disabled-password --shell /bin/bash --home /home/${USERAUX} --gecos ${USERAUX}  ${USERAUX}
else
	echo " --> The user exists ... nothing to do"
fi

echo " --> The user : ${USERAUX} must have the default passwd assigned"
echo "${USERAUX}:${PASSAUX}" | chpasswd

USERAUX="cuarto"
PASSAUX="QuickSort"

echo  " * [ Senia Default Users ] : Adding User [ ${USERAUX} ] "

rc=$DEFAULTRC
cat /etc/passwd | grep -q ${USERAUX}|| rc=1

if [ $rc -eq 1 ]; then
	echo " --> The user : ${USERAUX} not exists : creating..."
   	adduser --quiet --disabled-password --shell /bin/bash --home /home/${USERAUX} --gecos ${USERAUX}  ${USERAUX}
else
	echo " --> The user exists ... nothing to do"
fi

echo " --> The user : ${USERAUX} must have the default passwd assigned"
echo "${USERAUX}:${PASSAUX}" | chpasswd

USERAUX="batxi"
PASSAUX="HashTable"

echo  " * [ Senia Default Users ] : Adding User [ ${USERAUX} ] "

rc=$DEFAULTRC
cat /etc/passwd | grep -q ${USERAUX}|| rc=1

if [ $rc -eq 1 ]; then
	echo " --> The user : ${USERAUX} not exists : creating..."
   	adduser --quiet --disabled-password --shell /bin/bash --home /home/${USERAUX} --gecos ${USERAUX}  ${USERAUX}
else
	echo " --> The user exists ... nothing to do"
fi

echo " --> The user : ${USERAUX} must have the default passwd assigned"
echo "${USERAUX}:${PASSAUX}" | chpasswd



USERAUX="batxii"
PASSAUX="BTree+"

echo  " * [ Senia Default Users ] : Adding User [ ${USERAUX} ] "

rc=$DEFAULTRC
cat /etc/passwd | grep -q ${USERAUX}|| rc=1

if [ $rc -eq 1 ]; then
	echo " --> The user : ${USERAUX} not exists : creating..."
   	adduser --quiet --disabled-password --shell /bin/bash --home /home/${USERAUX} --gecos ${USERAUX}  ${USERAUX}
else
	echo " --> The user exists ... nothing to do"
fi

echo " --> The user : ${USERAUX} must have the default passwd assigned"
echo "${USERAUX}:${PASSAUX}" | chpasswd



exit 0
